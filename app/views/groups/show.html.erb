<% if @user_role == :admin %>
<section>
  <h3><%= link_to "Attendance", group_events_path(@group) %></h3>
  <table class="student_data">
    <%= render partial: "memberships/data_table", locals: {group: @group, users: @subnonadmins, datum: :attendances} %>
  </table>
</section>

<section>
  <h3><%= link_to "Assignments", group_assignments_path(@group) %></h3>
  <table class="student_data">
    <%= render partial: "memberships/data_table", locals: {group: @group, users: @subnonadmins, datum: :submissions} %>
  </table>
</section>

<section>
  <h3><%= link_to "Observations", group_observations_path(@group) %></h3>
  <table class="student_data">
    <%= render partial: "memberships/data_table", locals: {group: @group, users: @subnonadmins, datum: :observations} %>
  </table>
</section>
<% end %>

<section>
  <h3>Members</h3>

  <section>
    <h4>Members</h4>
    <table>
      <% @nonadmins.each do |user| %>
      <tr>
        <%= render partial: "users/user_row", locals: {user: user} %>
        <td><%= link_to "Remove", group_membership_path(@group, user), method: :delete, data: {confirm: "Are you sure you want to delete this?"} %></td>
      </tr>
      <% end %>
    </table>
    <% if @user_role == :member %>
    <%= link_to "Check your report card", group_membership_path(@group, current_user), class: "button" %>
    <% end %>
  </section>

  <section>
  <h4>Admins</h4>
    <table>
      <% @admins.each do |user| %>
      <tr>
        <%= render partial: "users/user_row", locals: {user: user} %>
      </tr>
      <% end %>
    </table>
  </section>

  <% if @user_role == :admin %>
  <section>
    <h4>Add Members</h4>
    <%= form_tag group_memberships_path(@group), method: :post do %>
    <input name="usernames" placeholder="One or more usernames, separated by spaces and/or commas" />
    <input type="checkbox" name="is_admin" id="is_admin" />
    <label for="is_admin">Is admin</label>
    <input type="submit" value="Add members" />
    <% end %>
  </section>
  <% end %>

</section>

<section>
  <% if @user_role == :admin %>
  <h3>Group</h3>
  <section>
    <h4>Edit Group</h4>
    <div>
    <%= render partial: "form", locals: {group: @group, action: group_path(@group), method: :patch} %>
    <%= link_to "Delete group", group_path(@group), method: :delete, class: "button", data: {confirm: "You sure? This will orphan all of the grades, attendances, and everything else."} %>
    </div>
  </section>
  <% end %>

  <section>
    <h4>Subgroups</h4>
    <ul class="tree"><%= group_descendant_list(@group) %></ul>
  </section>

  <% if @user_role == :admin %>
  <section>
    <h4>Create subgroup</h4>
    <%= render partial: "form", locals: {group: @newgroup, action: group_path(@group), method: :post} %>
  </section>
  <% end %>
</section>
